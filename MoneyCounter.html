<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CashBox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <style>
    :root{
      --bg:#f6f8fb; --card:#fff; --text:#0f172a; --muted:#64748b; --line:#e5e7eb;
      --accent:#2563eb; --accent-2:#60a5fa; --success:#16a34a;
      --radius:16px; --shadow:0 8px 30px rgba(2,6,23,.08);
      --w: clamp(320px, 95vw, 1000px);
      --font-base: clamp(15px, 0.8vw + 14px, 16px);
      --font-sm: clamp(13px, 0.5vw + 12px, 14px);
      --font-lg: clamp(18px, 1vw + 16px, 22px);
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b1220; --card:#0f172a; --text:#e5e7eb; --muted:#9aa4b2; --line:#1f2a44;
        --accent:#60a5fa; --accent-2:#93c5fd; --shadow:0 10px 30px rgba(0,0,0,.35);
      }
    }

    *{ box-sizing:border-box }
    html,body{ height:auto; min-height:100dvh }
    body{
      margin:0;
      font-family: ui-sans-serif,-apple-system,system-ui,"Segoe UI",Roboto,Arial,"Helvetica Neue",Helvetica,sans-serif;
      font-size: var(--font-base);
      color: var(--text);
      background:
        radial-gradient(1000px 400px at 10% -10%, rgba(96,165,250,.20), transparent 60%),
        radial-gradient(900px 500px at 120% 10%, rgba(37,99,235,.12), transparent 60%),
        var(--bg);
      display:grid; place-items:center;
      padding:
        calc(var(--safe-top) + clamp(12px, 3vw, 24px))
        clamp(12px, 3vw, 24px)
        calc(var(--safe-bottom) + clamp(12px, 3vw, 24px));
    }

    .card{
      width:min(100%, var(--w));
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .header{
      display:flex; align-items:center; gap:.5rem;
      padding: clamp(8px, 1.5vw, 12px) clamp(12px, 2vw, 16px);
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(37,99,235,.06), transparent 60%);
    }
    .logo{
      width: clamp(28px, 6vw, 36px);
      height: clamp(28px, 6vw, 36px);
      border-radius:8px; display:grid; place-items:center;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color:#fff; font-weight:800; font-size: var(--font-sm);
    }
    .title{ margin:0; font-size: var(--font-lg); line-height:1.1 }
    .subtitle{ margin:.2rem 0 0; color:var(--muted); font-size: var(--font-sm) }

    .content{
      padding: clamp(8px, 2vw, 12px) clamp(12px, 3vw, 16px) clamp(8px, 2vw, 12px);
      display: grid;
      gap: 1rem;
    }

    /* Two column layout for panels */
    .panel-grid{
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    @media (min-width: 768px){
      .panel-grid{ grid-template-columns: 1fr 1fr; }
    }

    .panel{
      border:1px solid var(--line);
      border-radius:12px;
      padding: clamp(8px, 2vw, 12px);
      background: linear-gradient(180deg, rgba(0,0,0,.02), transparent 70%);
    }
    .panel h2{
      margin:.25rem 0 .6rem; font-size:1.05rem;
      color: var(--muted); font-weight:700;
    }

    table{
      width:100%; border-collapse:separate; border-spacing:0;
      border:1px solid var(--line); border-radius:12px; overflow:hidden;
      margin-bottom:.5rem;
    }
    thead th{
      background:linear-gradient(180deg,#dbeafe,#bfdbfe);
      color:#0b3b73; text-align:right;
      padding:.4rem .6rem;
      font-weight:700; font-size:.9rem;
      border-bottom:1px solid var(--line);
    }
    @media (prefers-color-scheme: dark){
      thead th{ background:linear-gradient(180deg,#0f2546,#0a1a33); color:#cfe3ff }
    }
    th:first-child, td:first-child{ text-align:center }
    td{
      padding:.4rem .6rem;
      border-bottom:1px solid var(--line);
    }
    tbody tr:nth-child(odd) td{ background: rgba(99,102,241,0.03) }
    tbody tr:last-child td{ border-bottom:none }
    tfoot td{
      padding:.5rem;
      font-weight:800; border-top:1px solid var(--line);
      background:linear-gradient(180deg, rgba(37,99,235,.05), transparent);
      text-align:right;
    }

    /* Safari dark mode: hide native steppers */
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button{
      -webkit-appearance: none;
      margin: 0;
    }
    input[type="number"]{
      -moz-appearance: textfield;
      width: clamp(5rem, 24vw, 7rem);
      padding:.35rem .5rem;
      border:1px solid var(--line); border-radius:10px;
      background:transparent; color:inherit; text-align:right;
      font-variant-numeric: tabular-nums; outline:none;
      font-size: clamp(1rem, 4vw, 1.1rem);
      -webkit-text-size-adjust: 100%;
    }
    input[type="number"]:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 25%, transparent);
      background: color-mix(in srgb, var(--accent) 8%, transparent);
    }
    input[readonly]{
      width: clamp(6rem, 28vw, 9rem);
      border:none; background:transparent; color:inherit;
      text-align:right; font-weight:600;
      font-variant-numeric: tabular-nums;
    }

    /* Custom +/- controls for Cash counts */
    .numwrap{
      display:flex;
      justify-content:center;
      align-items:center;
      gap:.35rem;
    }
    .stepbtn{
      width: 2.1rem;
      height: 2.1rem;
      border-radius: 10px;
      border: 1px solid var(--line);
      background: color-mix(in srgb, var(--card) 85%, transparent);
      color: var(--text);
      font-weight: 800;
      line-height: 1;
      cursor: pointer;
      user-select: none;
    }
    .stepbtn:active{ transform: translateY(1px); }

    @media (pointer: coarse){
      .stepbtn{ width: 2.4rem; height: 2.4rem; }
    }

    .summary{
      display:grid; gap:.4rem;
      grid-template-columns: 1fr auto;
      border:1px solid var(--line);
      border-radius:12px;
      padding: clamp(8px, 2vw, 12px);
      background: linear-gradient(180deg, rgba(0,0,0,.02), transparent 70%);
    }
    .summary label{ color:var(--muted); font-weight:600 }
    .summary output{
      font-weight:800; font-variant-numeric: tabular-nums;
      text-align:right;
    }

    .actions{
      display:flex; gap:.6rem; justify-content:flex-end;
      padding: clamp(8px, 2vw, 12px);
      border-top:1px solid var(--line);
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.02));
    }
    .btn{
      appearance:none; border:none; cursor:pointer;
      padding:.5rem 1rem;
      border-radius:999px; font-weight:600;
    }
    .btn.primary{ background:linear-gradient(135deg,var(--accent),var(--accent-2)); color:#fff; }
    .btn.ghost{ background:transparent; color:var(--text); border:1px solid var(--line) }

@media print{
  /* Tell the browser to use normal page sizing */
  @page{
    size: auto;
    margin: 12mm;
  }

  body{
    background:#fff !important;
    padding:0 !important;
    display:block !important;
  }

  /* Remove the "card" constraints that can cause clipping */
  .card{
    width: 95% !important;
    max-width: none !important;
    border: none !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    overflow: visible !important;
  }

  .content{
    padding: 0 !important;
    gap: 10mm !important;
  }

  /* IMPORTANT: stack panels for print so right side isn't cut off */
  .panel-grid{
    grid-template-columns: 1fr !important;
  }

  /* Give panels a little breathing room, no fancy background */
  .panel{
    padding: 0 !important;
    border: none !important;
    background: none !important;
  }

  table{
    width: 100% !important;
    max-width: 100% !important;
    border: 1px solid #000 !important; /* crisp print */
  }

  /* Hide things you don't want on paper */
  .header, .actions, .stepbtn{
    display:none !important;
  }

  /* Inputs print as plain text */
  input{
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
    color: #000 !important;
    padding: 0 !important;
  }

  input[readonly]{
    font-weight: 700 !important;
  }

  /* Ensure totals row/summary doesn't get awkwardly split */
  .summary{
    break-inside: avoid;
    page-break-inside: avoid;
    border: 1px solid #000 !important;
  }
}
  </style>
</head>
<body>
  <main class="card">
    <header class="header">
      <div class="logo">¢$</div>
      <div>
        <h1 class="title">CashBox</h1>
        <p class="subtitle">Get those deposits ready!</p>
      </div>
    </header>

    <section class="content">
      <form id="moneyForm" autocomplete="off">
        <div class="panel-grid">
          <!-- Cash panel -->
          <section class="panel">
            <h2>Cash</h2>
            <table>
              <thead><tr><th>Count</th><th>Denomination</th><th>Total</th></tr></thead>
              <tbody id="cash-rows"></tbody>
              <tfoot><tr><td></td><td>Cash Total</td><td><input id="grandTotalCash" readonly tabindex="-1" /></td></tr></tfoot>
            </table>
          </section>

          <!-- Checks panel -->
          <section class="panel">
            <h2>Checks</h2>
            <table>
              <thead><tr><th>#</th><th>Amount</th><th>Formatted</th></tr></thead>
              <tbody id="check-rows"></tbody>
              <tfoot><tr><td></td><td>Checks Total</td><td><input id="checksTotal" readonly tabindex="-1" /></td></tr></tfoot>
            </table>
          </section>
        </div>

        <!-- Summary below the two columns -->
        <section class="summary">
          <label>Cash</label><output id="summaryCash">$0.00</output>
          <label>Checks</label><output id="summaryChecks">$0.00</output>
          <label>Total (Cash + Checks)</label><output id="summaryBoth">$0.00</output>
        </section>

        <div class="actions">
          <button type="button" class="btn primary" onclick="window.print()">Print</button>
          <button type="reset" class="btn ghost">Reset</button>
        </div>
      </form>
    </section>
  </main>

  <script>
    const usd = new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});
    const toUsd=c=>usd.format(c/100);
    const parseMoneyToCents=s=>{
      if(!s)return 0;
      const c=String(s).replace(/[^\d.]/g,"");
      if(!c)return 0;
      const p=c.split(".");
      let n=0;
      if(p.length===1) n=parseInt(p[0])*100;
      else{
        const w=parseInt(p[0]||"0");
        const f=(p[1]||"0").slice(0,2).padEnd(2,"0");
        n=w*100+parseInt(f);
      }
      return isNaN(n)?0:n
    };

    const DENOMS=[
      {key:"pny",label:"1¢",cents:1},
      {key:"nck",label:"5¢",cents:5},
      {key:"dme",label:"10¢",cents:10},
      {key:"qtr",label:"25¢",cents:25},
      {key:"hlf",label:"50¢",cents:50},
      {key:"one",label:"$1.00",cents:100},
      {key:"fiv",label:"$5.00",cents:500},
      {key:"ten",label:"$10.00",cents:1000},
      {key:"twe",label:"$20.00",cents:2000},
      {key:"fif",label:"$50.00",cents:5000},
      {key:"hun",label:"$100.00",cents:10000}
    ];

    const cashTbody=document.getElementById("cash-rows");
    const checkTbody=document.getElementById("check-rows");
    const cashTotalEl=document.getElementById("grandTotalCash");
    const checksTotalEl=document.getElementById("checksTotal");
    const summaryCash=document.getElementById("summaryCash");
    const summaryChecks=document.getElementById("summaryChecks");
    const summaryBoth=document.getElementById("summaryBoth");

    // Build cash rows WITH +/- buttons
    DENOMS.forEach(d=>{
      const tr=document.createElement("tr");

      const tdCount=document.createElement("td");
      tdCount.style.textAlign="center";

      const wrap=document.createElement("div");
      wrap.className="numwrap";

      const minus=document.createElement("button");
      minus.type="button";
      minus.className="stepbtn";
      minus.textContent="−";
      minus.setAttribute("aria-label",`Decrease ${d.label}`);

      const input=document.createElement("input");
      input.type="number";
      input.min="0";
      input.step="1";
      input.inputMode="numeric";
      input.id=d.key;

      const plus=document.createElement("button");
      plus.type="button";
      plus.className="stepbtn";
      plus.textContent="+";
      plus.setAttribute("aria-label",`Increase ${d.label}`);

      minus.addEventListener("click",()=>{
        const v=parseInt(input.value||"0",10);
        if(v>0) input.value=String(v-1);
        input.dispatchEvent(new Event("input",{bubbles:true}));
      });
      plus.addEventListener("click",()=>{
        const v=parseInt(input.value||"0",10);
        input.value=String(v+1);
        input.dispatchEvent(new Event("input",{bubbles:true}));
      });

      wrap.append(minus,input,plus);
      tdCount.appendChild(wrap);

      const tdDen=document.createElement("td");
      tdDen.style.textAlign="right";
      tdDen.textContent=d.label;

      const tdTot=document.createElement("td");
      tdTot.style.textAlign="right";
      tdTot.innerHTML=`<input id="${d.key}Tot" readonly tabindex="-1">`;

      tr.append(tdCount,tdDen,tdTot);
      cashTbody.appendChild(tr);
    });

    let checkCount=0;
    function addCheckRow(){
      checkCount++;
      const tr=document.createElement("tr");
      tr.innerHTML=`<td>${checkCount}</td>
        <td><input type="number" step="0.01" inputmode="decimal" id="chk_${checkCount}" placeholder="0.00"></td>
        <td style="text-align:right"><input id="chk_${checkCount}_fmt" readonly tabindex="-1"></td>`;
      checkTbody.appendChild(tr);
    }

    function ensureExtraCheckRow(){
      const inputs=checkTbody.querySelectorAll('input[type="number"]');
      if(inputs.length===0||inputs[inputs.length-1].value.trim()!=="") addCheckRow();
    }

    function calcCash(){
      let c=0;
      DENOMS.forEach(d=>{
        const v=parseInt(document.getElementById(d.key).value||0,10);
        const s=v*d.cents; c+=s;
        document.getElementById(`${d.key}Tot`).value=s?toUsd(s):"";
      });
      cashTotalEl.value=toUsd(c);
      return c;
    }

    function calcChecks(){
      let c=0;
      const inputs=checkTbody.querySelectorAll('input[type="number"]');
      inputs.forEach(inp=>{
        const cents=parseMoneyToCents(inp.value.trim());
        c+=cents;
        document.getElementById(`${inp.id}_fmt`).value=cents?toUsd(cents):"";
      });
      checksTotalEl.value=toUsd(c);
      return c;
    }

    function calcAll(){
      const cash=calcCash(),checks=calcChecks();
      summaryCash.textContent=toUsd(cash);
      summaryChecks.textContent=toUsd(checks);
      summaryBoth.textContent=toUsd(cash+checks);
    }

    document.getElementById("moneyForm").addEventListener("input",e=>{
      if(e.target.matches('#cash-rows input')) calcAll();
      if(e.target.matches('#check-rows input')){
        ensureExtraCheckRow();
        calcAll();
      }
    });

    document.getElementById("moneyForm").addEventListener("reset",()=>{
      setTimeout(()=>{
        cashTbody.querySelectorAll('input[type="number"]').forEach(i=>i.value="");
        checkTbody.innerHTML=""; checkCount=0; addCheckRow(); calcAll();
      },0);
    });

    window.addEventListener("DOMContentLoaded",()=>{ addCheckRow(); calcAll(); });
  </script>
</body>
</html>
